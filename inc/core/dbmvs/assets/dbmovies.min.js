!function(e){var s={},t=dbmovies.ajaxurl,a=dbmovies.dapiurl,o=dbmovies.tapiurl,i=dbmovies.dapikey,n=dbmovies.tapikey,r=dbmovies.apilang,d=dbmovies.safemod,l=dbmovies.extimer,m=dbmovies.inscrll,c=dbmovies.rscroll,p=dbmovies.csectin,v=dbmovies.nocrdt,u=dbmovies.gerepis,b=navigator.onLine,g="#dbmovies-generartor",h="#dbmovies-updaterpost",f="#dbmovies-json-response",_="#dbmovies-importer",C="#dbmovies-generator-seasons",k="#dbmovies-generator-episodes",y="#dbmovies-imdb-updater-page";function S(s,t){var a=e.animateNumber.numberStepFactories.separator(",");e(s).animateNumber({number:t,numberStep:a},1500)}function w(e){return e.split("").reverse().join("")}function T(e){var s=e.elem;s.nodeType&&s.parentNode&&(s._animateNumberSetter||E.numberStep)(e.now,e)}e(function(){s.GetStats(),s.GenerateSeEp(),s.PostGenerateSeEp(),s.GenerateAllEpisodesGet(),s.UpdaterEditorPost(),s.GenerateEditor(),s.NavSettings(),s.SaveSettings(),s.GoTop(),s.LogCollapse(),s.Auth(),s.IMDbUpdater(),s.CodeStarTab(),s.Application(),s.Search(),s.Filter(),s.LoadMore(),s.Importer(),s.Cimport(),s.GeneratorSeasons(),s.GeneratorEpisodes(),s.ReubicateForm(),s.LogCleaner(),s.InternetCon(),s.Dashboard(),s.MetaUpdater()}),s.GetStats=function(){1==e("#dbmvs_global_stats").length&&(e(document).ready(function(){s.Stats()}),setInterval(function(){s.Stats()},6e4))},s.Stats=function(){e("#last_cache").html(dooAj.loading),e.getJSON(a+"/?stats=all",function(s){e.each(s,function(e,s){S("#dbmvs_"+e,s)}),e("#last_cache").html(s.last_cache)})},s.MetaUpdater=function(){var a,o,i,n="dbmovies_metaupdater",r="#dbmvs-metaupdater";StatusMU="#dbmvs-metaupdater-status",Proccess="#meta-updater-process",MControl="#meta-updater-controls",MtUPause="#meta-updater-pause",RunMTUpT="#meta-updater-run",1!=r.length&&(a=s.getCookie("_dbmvs_metaupdater_status"),o=s.getCookie("_dbmvs_metaupdater_progress"),i=s.getCookie("_dbmvs_metaupdater_running"),"paused"==a&&(e(StatusMU).val(o),e(Proccess).show(),e(Proccess+"> span.spinner").hide(),e(Proccess+"> .proccess-bar > .into").addClass("flashit"),e(Proccess+"> span.percentage").text(s.NumberFormat(o)+" %"),e(RunMTUpT).hide(),e(MtUPause).hide(),e(MControl).show(),e(Proccess+"> .proccess-bar > .into").animate({width:o+"%"},150,function(){})),1==i&&"paused"!=a&&(e(Proccess+"> span.percentage").text(s.NumberFormat(o)+" %"),e(Proccess+"> .proccess-bar > .into").animate({width:o+"%"},1e3,function(){}),setTimeout(function(){e(r).trigger("click")},1e3)),e(document).on("click","#dbmvs-finish-metaupdater",function(){var a=e(this).data("control");return confirm("You are about to interrupt the process")&&(e(MtUPause).hide(),e(Proccess).hide(),e(MControl).hide(),e(RunMTUpT).show(),e(Proccess+"> span.spinner").show(),e(Proccess+"> .proccess-bar > .into").removeClass("flashit"),e(StatusMU).val("progress"),e.ajax({url:t,type:"POST",dataType:"json",data:{action:n,process:a},success:function(t){s.delCookie("_dbmvs_metaupdater_running"),s.delCookie("_dbmvs_metaupdater_status"),s.delCookie("_dbmvs_metaupdater_progress"),e("#dbmvs-log-indicator").after('<li class="shake"><span class="type error">dbmvs</span>'+t.message+"</li>")}})),!1}),e(document).on("click",r,function(){var a=e(StatusMU).val(),o=e(this).data("control");return"progress"==a&&(e(MtUPause).show(),e(Proccess).show(),e(RunMTUpT).hide(),e.ajax({url:t,type:"POST",dataType:"json",data:{action:n,process:o},success:function(t){1==t.success?(e(r).trigger("click"),e(Proccess+"> .proccess-bar > .into").animate({width:t.progress+"%"},150,function(){}),e(Proccess+"> span.percentage").text(s.NumberFormat(t.progress)+" %"),s.setCookie("_dbmvs_metaupdater_progress",t.progress,30),s.setCookie("_dbmvs_metaupdater_running",1,30),s.ComposeItemLog(t.content)):(s.delCookie("_dbmvs_metaupdater_running"),s.delCookie("_dbmvs_metaupdater_status"),s.delCookie("_dbmvs_metaupdater_progress"),e(Proccess+"> .proccess-bar > .into").animate({width:"0%"},800,function(){}),setTimeout(function(){e(MtUPause).hide(),e(Proccess).hide(),e(MControl).hide(),e(RunMTUpT).show(),e(Proccess+"> span.spinner").show(),e(Proccess+"> .proccess-bar > .into").removeClass("flashit"),e(StatusMU).val("progress")},1e3))}})),!1}),e(document).on("click",".metaupdater-control",function(){switch(e(this).data("control")){case"continue":e(MControl).hide(),e(MtUPause).show(),e(Proccess+"> span.spinner").show(),e(Proccess+"> .proccess-bar > .into").removeClass("flashit"),e(StatusMU).val("progress"),s.setCookie("_dbmvs_metaupdater_status","progress",30),setTimeout(function(){e(r).trigger("click")},500);break;case"finish":break;case"pause":e(Proccess+"> span.spinner").hide(),e(Proccess+"> .proccess-bar > .into").addClass("flashit"),e(MtUPause).hide(),e(MControl).show(),e(StatusMU).val("paused"),s.setCookie("_dbmvs_metaupdater_status","paused",30)}return!1}))},s.TimeSince=function(e){var s=Math.floor((Date.now()-e)/1e3),t=dbmovies.timest.seconds;return s<0&&(s=-s),e=s,31536e3<=s?t=1!=(e=Math.floor(s/31536e3))?dbmovies.timest.years:dbmovies.timest.year:2592e3<=s?t=1!=(e=Math.floor(s/2592e3))?dbmovies.timest.months:dbmovies.timest.month:604800<=s?t=1!=(e=Math.floor(s/604800))?dbmovies.timest.weeks:dbmovies.timest.week:86400<=s?t=1!=(e=Math.floor(s/86400))?dbmovies.timest.days:dbmovies.timest.day:3600<=s?t=1!=(e=Math.floor(s/3600))?dbmovies.timest.hours:dbmovies.timest.hour:60<=s&&(t=1!=(e=Math.floor(s/60))?dbmovies.timest.minutes:dbmovies.timest.minute),e+" "+t},s.Dashboard=function(){var a=e("#dbmovies-inboxes-nonce").val();1==e("#dooplay_dashboard_widget").length&&(1==dbmovies.formrpt?(e("#doodashcont-reported-click").addClass("active"),e("#doodashcont-reported").addClass("on")):1==dbmovies.formcot&&0==dbmovies.formrpt&&(e("#doodashcont-reported-click").remove(),e("#doodashcont-reported").remove(),e("#doodashcont-inbox-click").addClass("active"),e("#doodashcont-inbox").addClass("on")),0==dbmovies.formcot&&(e("#doodashcont-inbox-click").remove(),e("#doodashcont-inbox").remove())),e(document).on("click",".dooplay-dashaboard-navigation",function(){var s=e(this).attr("data-id");s&&(e(".dooplay-dashaboard-navigation").removeClass("active"),e(this).addClass("active"),e(".dashcont").removeClass("on"),e("#doodashcont-"+s).addClass("on"))}),1==e("#response-inboxes-report").length&&1==dbmovies.formrpt&&s.GetDataInboxes("report",1,a),1==e("#response-inboxes-contact").length&&1==dbmovies.formcot&&s.GetDataInboxes("contact",1,a),e(document).on("click",".inboxes-loadmore",function(){var t=e(this).data("type"),o=e("#inboxes-input-"+t).val();return e("#response-inboxes-"+t).addClass("loader"),e(this).prop("disabled",!0),console.log(this),s.GetDataInboxes(t,o,a,this),!1}),e(document).on("click",".close-inboxes",function(){var s=e(this).data("type");s="#post-"+e(this).data("id")+"-"+s;return 1==e(s+" > div.message").length&&(e(s).removeClass("reading"),e(s).addClass("read"),e(s+" > .message").remove()),!1}),e(document).on("click",".inboxes-readme-message.unread",function(){var s="#response-count-"+e(this).data("type")+"-unread",t=parseInt(e(s).text());e(s).text(t-1),e(s+"-span").text("("+(t-1)+")")}),e(document).on("click",".inboxes-delete-post",function(){var s=e(this).data("type"),o=e(this).data("id"),i="#post-"+o+"-"+s;return e(i).hide(),e.ajax({url:t,type:"POST",dataType:"json",data:{action:"dbmovies_inboxes_deleting",post:o,type:s,nonce:a},success:function(t){1==t.success?(e(i).remove(),e("#response-count-"+s+"-unread-span").text("("+t.unread+")"),e("#response-count-"+s+"-unread").text(t.unread),e("#response-count-"+s+"-total").text(t.total),0==t.total&&e("#response-inboxes-"+s+" > .hidden").before('<div class="inboxes-notice"><p>'+dbmovies.nocont+"</p></div>")):e(i).show()}}),!1}),e(document).on("click",".inboxes-readme-message",function(){var s=e(this).data("type"),o=e(this).data("id"),i="#post-"+o+"-"+s;return e(this).removeClass("unread"),e(this).addClass("read"),1!=e(i+" > div.message").length?(e("#response-inboxes-"+s+" > .item > .message").remove(),e("#response-inboxes-"+s+" > .item").removeClass("reading"),e(i).removeClass("unread"),e(i).addClass("reading"),e(i+" > h4").after('<div class="message"><div class="onload"></div></div>'),e.ajax({url:t,type:"POST",dataType:"html",data:{action:"dbmovies_inboxes_reading",type:s,post:o,nonce:a},success:function(s){e(i).addClass("read"),e(i+" > .message").addClass("fadein"),e(i+" > .message").html(s)}})):(e(i+" > .message").removeClass("fadein"),e(i+" > .message").addClass("shake"),setTimeout(function(){e(i+" > .message").removeClass("shake")},800)),!1})},s.GetDataInboxes=function(a,o,i,n){e.getJSON(t+"?action=dbmovies_inboxes&type="+a+"&page="+o+"&nonce="+i,function(t){e("#response-count-"+a+"-unread-span").text("("+t.unread+")"),e("#response-count-"+a+"-unread").text(t.unread),e("#response-count-"+a+"-total").text(t.total);var i=[];e("#response-inboxes-"+a+" > .onload").remove(),e("#response-inboxes-"+a).removeClass("loader"),t.posts&&(e.each(t.posts,function(e,t){var o='<div id="post-'+t.ID+"-"+a+'" class="fadein item '+t.post_status+'" data-id="'+t.ID+'">',n='<a href="#" class="inboxes-delete-post" data-id="'+t.ID+'" data-type="'+a+'"><i class="dashicons dashicons-trash"></i></a>',r='<span class="date">'+s.TimeSince(new Date(t.post_date))+"</span>";t='<a href="#" data-id="'+t.ID+'" data-type="'+a+'" class="inboxes-readme-message '+t.post_status+'">'+t.post_title+"</a></h4></div>";i.push(o+'<h4 class="title"><i class="dashicons dashicons-email"></i>'+n+r+t)}),e("#response-inboxes-"+a+" > .hidden").before(i.join("")),e(n).prop("disabled",!1),t.pages>o?(e("#inboxes-paginator-"+a).removeClass("hidden"),e("#inboxes-input-"+a).val(Math.floor(parseInt(o)+1))):e("#inboxes-paginator-"+a).addClass("hidden")),0==t.total&&e("#response-inboxes-"+a+" > .hidden").before('<div class="inboxes-notice"><p>'+dbmovies.nocont+"</p></div>"),t.error&&e("#response-inboxes-"+a+" > .hidden").before('<div class="inboxes-notice"><p>'+t.error+"</p></div>")})},s.InternetCon=function(){b||console.log("No hay conexion a Internet")},s.LogCleaner=function(){Cleaner="#dbmovies-cleanlog",e(document).on("click",Cleaner,function(){return e(Cleaner).html(dbmovies.cleangn),setTimeout(function(){e("#dbmovies-logs-box > ul").html('<i id="dbmvs-log-indicator"></i><li class="jump"><span class="type">dbmvs</span>'+dbmovies.cllogs+"</li>"),e(Cleaner).html(dbmovies.cleancl)},200),!1})},s.GenerateSeEp=function(){e(document).on("click","#dbmvseaepbtncl",function(){var s=e("#dbmvgsepare").val();return e("#dbgesbtn_"+s).show(),e("#dbmvs_seaepi_generator").hide(),setTimeout(function(){e("#dbmvseaepbtncl").addClass("hidden"),e("#dbmvseaepico").removeClass("done"),e("#dbmvseaepico").addClass("loading"),e("#dbmvseaeprgrs").removeClass("flashit"),e("#dbmvgseitem").val("1"),e("#dbmvgsetmdb").val(""),e("#dbmvgsetotl").val(""),e("#dbmvgsepare").val(""),e("#dbmvgsetype").val(""),e("#dbmvgsename").val(""),e("#dbmvgseseas").val("")},700),!1}),e(document).on("click",".dbmvsarchiveseep",function(){var s,t,d,l;return i&&(e(this).hide(),e("#dbmvs_seaepi_generator").show(),s=e(this).data("parent"),t=e(this).data("tmdb"),d=e(this).data("season"),l=e(this).data("type"),e.getJSON(a+"/?check="+i,function(a){e("#dbmvgsepare").val(s),e("#dbmvgsetmdb").val(t),e("#dbmvgsetype").val(l),e("#dbmvgseseas").val(d),(1==a.status&&1<=a.credits||1==a.status&&1==a.unlimited)&&e.getJSON(o+"/tv/"+t+"?language="+r+"&api_key="+n,function(s){var t=s.name||s.original_name;switch(e("#dbmvgsename").val(t),l){case"seasons":e("#dbmvgsetotl").val(s.number_of_seasons);break;case"episodes":e.each(s.seasons,function(s,t){d==t.season_number&&e("#dbmvgsetotl").val(t.episode_count)})}e("#dbmvseaeptxt").html(""),e("#dbmvseaeprgrs").show(),e("#dbmvseaeprgrs").addClass("flashit"),e("#dbmvseaepbtncl").removeClass("hidden"),e("#dbmvseaepico").removeClass("loading"),e("#dbmvseaepico").addClass("done"),e("#dbmvseaepbtn").prop("disabled",!1)})})),!1})},s.PostGenerateSeEp=function(){e(document).on("submit","#dbmvseaepigenerator",function(){var a=e("#dbmvgsepare").val(),o=e("#dbmvgsetmdb").val(),i=parseInt(e("#dbmvgseitem").val()),n=parseInt(e("#dbmvgsetotl").val()),r=i/n*100;return e("#dbmvseaepbtn").hide(),e("#dbmvseaepbtncl").addClass("hidden"),e("#dbmvseaeprgrs").removeClass("flashit"),e("#dbmvseaepico").removeClass("done"),e("#dbmvseaepico").addClass("loading"),e("#dbmvseaeptxt").addClass("flashit"),e("#dbmvseaeptxt").html(dbmovies.loading),e("#gnrtse_"+a).html(dbmovies.prsseng),e.ajax({url:t,type:"POST",dataType:"json",data:e(this).serialize(),success:function(t){e("#dbmvgseitem").val(i+1),1==t.response?(t=i+" / "+n+" >> "+t.title+" >> "+t.mtime,console.log(t),e("#dbmvgseconsolelog").html(t),e("#dbmvseaeprgrs > span").animate({width:r+"%"},150,function(){}),i<n?setTimeout(function(){e("#dbmvseaepbtn").trigger("click")},100):s.PostGenerateSeEpFix(a,o)):s.PostGenerateSeEpFix(a,o)}}),!1})},s.PostGenerateSeEpFix=function(s,t){setTimeout(function(){e("#dbmvgseconsolelog").html(""),e("#dbmvgseitem").val("1"),e("#dbmvs_seaepi_generator").hide(),e("#dbmvseaeprgrs").hide(),e("#dbmvseaepbtn").show(),e("#gnrtse_"+s).html('<code class="ready">'+t+"</code>"),e("#dbmvseaepbtn").prop("disabled",!0),e("#dbmvseaeptxt").removeClass("flashit"),e("#dbmvseaeprgrs > span").animate({width:"0%"},200,function(){})},300)},s.GenerateAllEpisodesGet=function(){"all"==u&&e(document).ready(function(){e("#dbmovies-generator-epprepa").trigger("click")}),e(document).on("click",".dbmvs_generate_episodes",function(){e(this).hide()})},s.UpdaterEditorPost=function(){1==e(h).length&&e(document).on("click",h,function(){e("#dbmovies-message").remove(),e("#api_table").addClass("hidden_api"),e("#loading_api").html('<p><span class="spinner"></span>'+dbmovies.loading+"</p>"),i?e.getJSON(a+"/?check="+i,function(t){if(1==t.status&&1<=t.credits||1==t.status&&1==t.unlimited){var a=e("#post_type").val(),o=e("#ids").val(),i=e("#temporada").val(),n=e("#episodio").val();switch(a){case"movies":s.UpdateEditorMovies(o);break;case"tvshows":s.UpdateEditorTVShows(o);break;case"seasons":s.UpdateEditorSeasons(o,i);break;case"episodes":s.UpdateEditorEpisodes(o,i,n)}}else t.error?s.ErrorNoticeEditor(t.error):s.ErrorNoticeEditor(v)}).fail(function(){s.ErrorNoticeEditor(dbmovies.dbmverr)}):s.ErrorNoticeEditor(dbmovies.misskey)})},s.SetPostContent=function(s){var t,a;s&&"undefined"!=typeof tinymce&&(t=e("textarea#content").val(),(a=tinymce.get("content"))&&a instanceof tinymce.Editor?'<p><br data-mce-bogus="1"></p>'==a.startContent&&(a.setContent(s),a.save({no_events:!0})):t||e("textarea#content").val(s))},s.SetPostImages=function(s){var t;!e("#imagenes").val()&&s&&(t="",e.each(s,function(e,s){return!(9<e)&&void(t+=9==e?s.file_path:s.file_path+"\n")}),e("#imagenes").val(t))},s.TitleReplace=function(e,s,t,a,o){return e.replace("{name}",s).replace("{season}",a).replace("{episode}",o).replace("{year}",t)},s.ImagePreUpload=function(s){1==dbmovies.pupload&&s&&0==e("#postimagediv p img").length&&e("#postimagediv p").html('<ul><li><img src="https://image.tmdb.org/t/p/w500'+s+'"/> </li></ul>')},s.UpdateEditorMovies=function(t){var d=o+"/movie/"+t;apilan="?language="+r,imglan="&include_image_language="+r,aditin=",null&append_to_response=images&api_key="+n,e.getJSON(d.concat(apilan,imglan,aditin),function(t){s.SetPostContent(t.overview),s.SetPostImages(t.images.backdrops),e("#dt_poster").val(t.poster_path),e("#dt_backdrop").val(t.backdrop_path),e("#idtmdb").val(t.id),e("#original_title").val(t.original_title),e("#tagline").val(t.tagline),e("#release_date").val(t.release_date),e("#vote_average").val(t.vote_average),e("#vote_count").val(t.vote_count),e("#runtime").val(t.runtime)}),e.getJSON(a+"/?key="+i+"&imdb="+t,function(s){e("#imdbRating").val(s.rating),e("#imdbVotes").val(s.votes),e("#Rated").val(s.rated),e("#Country").val(s.country)}),s.ErrorFixedEditor()},s.UpdateEditorTVShows=function(t){t=o+"/tv/"+t,apilan="?language="+r,imglan="&include_image_language="+r,aditin=",null&append_to_response=images&api_key="+n,e.getJSON(t.concat(apilan,imglan,aditin),function(t){s.SetPostContent(t.overview),s.SetPostImages(t.images.backdrops),e("#dt_poster").val(t.poster_path),e("#dt_backdrop").val(t.backdrop_path),e("#original_name").val(t.original_name),e("#first_air_date").val(t.first_air_date),e("#last_air_date").val(t.last_air_date),e("#number_of_seasons").val(t.number_of_seasons),e("#number_of_episodes").val(t.number_of_episodes),e("#imdbRating").val(t.vote_average),e("#imdbVotes").val(t.vote_count),e("#episode_run_time").val(t.episode_run_time[0])}),s.ErrorFixedEditor()},s.UpdateEditorSeasons=function(t,a){t=o+"/tv/"+t,apilan="?language="+r,aditin="&api_key="+n,e.getJSON(t.concat(apilan,aditin),function(t){e("#serie").val(t.name),e("#title").val()||(e("label#title-prompt-text").addClass("screen-reader-text"),e("#title").val(s.TitleReplace(dbmovies.titseas,t.name,null,a,null))),e.each(t.seasons,function(t,o){a==o.season_number&&(s.SetPostContent(o.overview),s.ImagePreUpload(o.poster_path),e("#dt_poster").val(o.poster_path),e("#air_date").val(o.air_date))})}),s.ErrorFixedEditor()},s.UpdateEditorEpisodes=function(t,a,i){var d=o+"/tv/"+t;apiuep=o+"/tv/"+t+"/season/"+a+"/episode/"+i,apilan="?language="+r,aditin="&api_key="+n,imglan="&include_image_language="+r,rditin=",null&append_to_response=images&api_key="+n,e.getJSON(d.concat(apilan,aditin),function(t){t=t.name,title=e("#title").val(),e("#serie").val(t),title||(e("label#title-prompt-text").addClass("screen-reader-text"),e("#title").val(s.TitleReplace(dbmovies.titepis,t,null,a,i)))}),e.getJSON(apiuep.concat(apilan,imglan,rditin),function(t){var a;s.SetPostContent(t.overview),s.ImagePreUpload(t.still_path),e("#episode_name").val(t.name),e("#dt_backdrop").val(t.still_path),e("#air_date").val(t.air_date),!e("#imagenes").val()&&t.images.stills&&(a="",e.each(t.images.stills,function(e,s){return!(9<e)&&void(a+=9==e?s.file_path:s.file_path+"\n")}),e("#imagenes").val(a))}),s.ErrorFixedEditor()},s.GenerateEditor=function(){1==e(g).length&&e(document).on("click",g,function(){e("#dbmovies-message").remove(),e("#api_table").addClass("hidden_api"),e("#loading_api").html('<p><span class="spinner"></span>'+dbmovies.loading+"</p>"),i?e.getJSON(a+"/?check="+i,function(t){if(1==t.status&&1<=t.credits||1==t.status&&1==t.unlimited){var a=e("#post_type").val(),o=e("#post_ID").val(),i=e("#ids").val(),n=e("#temporada").val(),r=e("#episodio").val();switch(a){case"movies":case"tvshows":s.AddMainTitle(o,i,a);break;case"seasons":s.AddSeason(o,i,n,a);break;case"episodes":s.AddEpisode(o,i,n,r,a)}}else t.error?s.ErrorNoticeEditor(t.error):s.ErrorNoticeEditor(v)}).fail(function(){s.ErrorNoticeEditor(dbmovies.dbmverr)}):s.ErrorNoticeEditor(dbmovies.misskey)})},s.AddMainTitle=function(a,o,i){o?e.ajax({url:t,type:"POST",dataType:"json",data:{idpost:a,tmdbid:o,typept:i,action:"dbmovies_genereditor"},success:function(e){1==e.response&&window.location.replace(e.editlink),0==e.response&&s.ErrorNoticeEditor(e.message)}}):s.ErrorFixedEditor()},s.AddSeason=function(a,i,d,l){i&&d?e.getJSON(o+"/tv/"+i+"?language="+r+"&api_key="+n,function(o){e.ajax({url:t,type:"POST",dataType:"json",data:{idpost:a,tmdbid:i,typept:l,season:d,tvname:o.name,action:"dbmovies_genereditor"},success:function(e){1==e.response&&(e.message?s.ErrorNoticeEditor(e.message):window.location.replace(e.editlink)),0==e.response&&s.ErrorNoticeEditor(e.message)}})}).fail(function(){s.ErrorNoticeEditor(dbmovies.tmdberr)}):s.ErrorFixedEditor()},s.AddEpisode=function(a,i,d,l,m){i&&d&&l?e.getJSON(o+"/tv/"+i+"?language="+r+"&api_key="+n,function(o){e.ajax({url:t,type:"POST",dataType:"json",data:{idpost:a,tmdbid:i,typept:m,season:d,episde:l,tvname:o.name,action:"dbmovies_genereditor"},success:function(e){1==e.response&&(e.message?s.ErrorNoticeEditor(e.message):window.location.replace(e.editlink)),0==e.response&&s.ErrorNoticeEditor(e.message)}})}).fail(function(){s.ErrorNoticeEditor(dbmovies.tmdberr)}):s.ErrorFixedEditor()},s.ErrorNoticeEditor=function(s){e("#postbox-container-2").prepend('<div id="dbmovies-message" class="notice notice-warning"><p>'+s+"</p></div>"),e("#loading_api").html(""),e("#api_table").removeClass("hidden_api")},s.ErrorFixedEditor=function(){e("#loading_api").html(""),e("#api_table").removeClass("hidden_api")},s.NavSettings=function(){var t=s.getCookie("_dbmvs_tabname"),a="#dbmvs-nav-settings > li.nav-tab";1==e("#dbmvs-nav-settings").length&&setTimeout(function(){e("#settab-"+t).trigger("click")},1),e(document).on("click",a,function(){var t=e(this).data("tab");return 0!=t&&(e(a).removeClass("nav-tab-active"),e(".tab-content").removeClass("on"),e(this).addClass("nav-tab-active"),e("#dbmv-setting-"+t).addClass("on"),s.setCookie("_dbmvs_tabname",t,30)),!1})},s.SaveSettings=function(){var s="#dbmvsbtn-savesettings",a="#dbmvsssrespnc";e(document).on("submit","#dbmovies-settings",function(){return e(s).prop("disabled",!0),e(".tab-content").addClass("onprogress"),e.ajax({url:t,type:"POST",dataType:"json",data:e(this).serialize(),success:function(t){i&&1!=t.reload?(e(".tab-content").removeClass("onprogress"),e(a).addClass("fadein"),e(a).html(t.message),setTimeout(function(){e(s).prop("disabled",!1),e(a).html(""),e(a).removeClass("fadein")},1e3)):location.reload()}}),!1})},s.GoTop=function(){var s="#dbmovies-back-top";1==e(s).length&&(e(s).hide(),e(function(){e(window).scroll(function(){200<e(this).scrollTop()?e(s).fadeIn():e(s).fadeOut()}),e(s).click(function(){return e("body,html").animate({scrollTop:0},500),!1})}))},s.LogCollapse=function(){e(document).on("click",".dbmovies-log-collapse",function(){return e(this).toggleClass("expand"),e("#dbmovies-logs-box").toggleClass("expand"),!1})},s.Auth=function(){e.each(["#dbmvs-forms-response","#dbmovies-importer","#dbmovies-apistats",".dbmovies-tvshow-content-generator"],function(t,a){e(a).length&&(i?(s.ApiRemoteData(!0),setInterval(function(){s.ApiRemoteData(!1)},6e4)):(1==e("#dbmovies-dbmvs-application").length&&window.location.replace("admin.php?page=dbmvs-settings"),s.AuthModules()))}),e(document).on("click",".dbdata",function(){return!1}),e(document).on("click",".dbdata.consultor",function(){return e(".dbdata").removeClass("consultor"),s.ApiRemoteData(!1),setTimeout(function(){e(".dbdata").addClass("consultor")},1e4),!1})},s.ApiRemoteData=function(t){b?e.getJSON(a+"/?check="+i,function(a){"1"==a.status?(e(".dbmvs-credits").show(),S("#dbmvs-credits",a.credits),S("#dbmvs-credits-used",a.used_credits),S("#dbmvs-requests",a.requests),S("#dbmvs-autoembed",a.autoembed),1<=a.credits||1==a.unlimited?1==t&&(e("#dbmvs-logo-status").addClass("ready"),e("#dbmvs-log-indicator").after('<li class="fadein"><span class="type">dbmvs</span>'+dbmovies.welcom+"</li>")):(s.AuthModules(),e("#dbmvs-log-indicator").after('<li class="fadein bigmessage">'+v+"</li>"))):(s.AuthModules(),e("#dbmvs-log-indicator").after('<li class="fadein bigmessage">'+a.error+"</li>"),e("#dbmvs-logo-status").addClass("flashit error")),e(".dbmovies-logs").show()}):(e("#dbmvs-forms-response").remove(),e(".dbmovies-logs").show(),e("#dbmvs-log-indicator").after('<li class="bounce bigmessage">'+dbmovies.nointrn+"</li>"))},s.AuthModules=function(){e("#dbmvs-forms-response").remove(),e("#dbmovies-importer").remove(),e(".dbmovies-tvshow-content-generator").remove()},s.IMDbUpdater=function(){e(document).on("click","#dbmvs-imdb",function(){var s=parseInt(e(y).val());return e(this).hide(),e("#dbmovies-li-imdb > span.spinner").show(),e("#dbmovies-li-imdb > span.percentage").show(),e.ajax({url:t,type:"POST",dataType:"json",data:{page:s,action:"dbmovies_app_upimdb"},success:function(t){var a=[];1==t.response?(e(y).val(++s),e(".progressing").animate({width:t.prgss+"%"},50,function(){}),e("#dbmovies-li-imdb > span.percentage").html(t.prgss+"%"),e.each(t.imdb,function(e,s){var o=s.imdb,i=s.rating+" - ",n=(s.votes,s.title),r=s.plink,d='<span class="type">'+s.imdb+"</span>";r='<a href="'+r+'">'+n+"</a>",n='<span class="microtime">'+t.mtime+"</span>";o?a.push('<li class="jump">'+d+i+r+n+"</li>"):a.push('<li class="jump"><span class="error">'+s.message+"</span>"+n+"</li>")}),e("#dbmvs-log-indicator").after(a.join("")),setTimeout(function(){e("#dbmvs-imdb").trigger("click")},50)):(e("#dbmovies-li-imdb > span.percentage").hide(),e("#dbmovies-li-imdb > span.spinner").hide(),e("#dbmvs-imdb").show(),e(".progressing").animate({width:"0%"},4e3,function(){}),setTimeout(function(){location.reload()},4500))}}),!1})},s.CodeStarTab=function(){p&&(e(".cs-section").hide(),e(".cs-nav ul a").removeClass("cs-section-active"),e("#tab-"+p).addClass("cs-section-active"),e("#cs-tab-"+p).show())},s.ReubicateForm=function(){var s,t="#dbmvoies-importer-html";1==e(t).length&&(s=e(t).html(),e(".wp-header-end").after(s),e(t).remove())},s.Application=function(){var t=s.getCookie("_dbmvs_tabapp"),a=".dbmvs-tab-content";1==e("#dbmovies-dbmvs-application").length&&setTimeout(function(){e("#dbmvstabapp-"+t).trigger("click")},1),e(document).on("click",a,function(){var t;return e(this).hasClass("button-primary")||(t=e(this).data("type"),e(".genres").removeClass("on"),e("#genres-box-"+t).addClass("on"),e("#dbmvs-filter-type").val(t),e("#dbmvs-search-type").val(t),e(a).removeClass("button-primary"),e(this).addClass("button-primary"),s.FixingApiResults(),s.setCookie("_dbmvs_tabapp",t,30)),!1})},s.Cimport=function(){e.each(["#dbmvs-year","#dbmvs-movies-genres","#dbmvs-tvshows-genres","#dbmvs-filter-type","#dbmvs-popularity","#dbmvs-search-term"],function(t,a){e(document).on("change",a,function(){s.FixingApiResults()})}),e(document).on("click","#bulk-importer",function(){return e("#bulk-importer-click").hide(),e(".cimport").each(function(){var t=e(this),a=t.data("type"),o=t.data("tmdb");return t.hide(),t.removeClass("cimport"),e("#tmdb-"+o).removeClass("fadein"),e("#tmdb-"+o).removeClass("non-existent"),e("#tmdb-"+o).addClass("onload jump"),s.TMDbAppImport(a,o,!0,d),!1}),!1}),e(document).on("click",".cimport",function(){var t=e(this),a=t.data("type"),o=t.data("tmdb");return t.hide(),t.removeClass("cimport"),e("#tmdb-"+o).removeClass("fadein"),e("#tmdb-"+o).removeClass("non-existent"),e("#tmdb-"+o).addClass("onload jump"),s.TMDbAppImport(a,o,!1,!1),!1})},s.FixingApiResults=function(){e("#dbmovies-response-data").hide(),e("#dbmovies-loadmore").removeClass("search"),e("#dbmovies-loadmore").removeClass("filter"),e("#dbmvs-results-number").html(0),e("#bulk-importer-click").hide(),e("#dbmovies-loadmore").hide(),e("#dbmvs-page").val(1),e("#dbmvs-search-page").val(1),e("#dbmvs-total-results").text(0),e("#time-execution-seconds").text(0),e("#dbmvs-current-page").text(0),e(".item").remove()},s.TMDbAppImport=function(a,o,i,n){i&&!n&&setTimeout(function(){e("#bulk-importer").trigger("click")},l),e.ajax({url:t,type:"POST",dataType:"json",data:{ptype:a,ptmdb:o,action:"dbmovies_insert_tmdb"},success:function(t){s.ComposeItemLog(t),1==t.response?(e("#tmdb-"+o).removeClass("onload"),e("#tmdb-"+o).removeClass("fadein"),e("#tmdb-"+o).addClass("existent bounce"),n&&e("#bulk-importer").trigger("click")):(e("#tmdb-"+o).removeClass("onload"),e("#tmdb-"+o).addClass("error"),e("#cimprt-"+o).addClass("cimport"),e("#cimprt-"+o).show())}})},s.Search=function(){e(document).on("submit","#dbmovies-form-search",function(){return e("#dbmvs-btn-search").prop("disabled",!0),e("#dbmovies-loadmore").addClass("search disabled"),e("#dbmovies-loadmore").hide(),e("#dbmovies-loadmore-spinner").show(),e.ajax({url:t,type:"POST",dataType:"json",data:e(this).serialize(),success:function(t){var a=parseInt(e("#dbmvs-search-page").val());e("#current-page").val(t.page),e("#current-year").val(t.year),e("#dtotal-items").val(t.items),e("#dbmovies-response-data").show(),e("#dbmvs-total-results").text(s.NumberFormat(t.total)),e("#time-execution-seconds").text(t.mtime),e("#dbmvs-current-page").text(t.page),e("#dbmovies-loadmore-spinner").hide(),e("#dbmovies-loadmore").removeClass("disabled"),s.ComposeFilterLog(t),1==t.response&&(a<t.pages?e("#dbmovies-loadmore").show():e("#dbmovies-loadmore").removeClass("search"),e("#dbmvs-btn-search").prop("disabled",!1),s.ComposeResults(t.results)),0==t.response&&s.FixingApiResults()}}),!1})},s.Filter=function(){e("#current-page").val(),e("#current-year").val(),e(document).on("submit","#dbmovies-form-filter",function(){return e("#bulk-importer-click").hide(),e("#dbmovies-loadmore").hide(),e("#dbmovies-loadmore").addClass("filter disabled"),e("#dbmvs-btn-filter").prop("disabled",!0),e("#dbmovies-loadmore-spinner").show(),e.ajax({url:t,type:"POST",dataType:"json",data:e(this).serialize(),success:function(t){var a=parseInt(e("#dbmvs-page").val());e("#current-page").val(t.page),e("#current-year").val(t.year),e("#dtotal-items").val(t.items),e("#dbmovies-response-data").show(),e("#dbmovies-loadmore").removeClass("disabled"),e("#dbmvs-total-results").text(s.NumberFormat(t.total)),e("#time-execution-seconds").text(t.mtime),e("#dbmvs-current-page").text(t.page),s.ComposeFilterLog(t),e("#dbmovies-loadmore-spinner").hide(),1==t.response&&(a<t.pages&&e("#dbmovies-loadmore").show(),e("#bulk-importer-click").show(),e("#dbmvs-btn-filter").prop("disabled",!1),s.ComposeResults(t.results)),0==t.response&&(alert(t.message),e("#dbmvs-btn-filter").prop("disabled",!1),s.FixingApiResults())}}),!1})},s.ComposeResults=function(s){var t=[];e.each(s,function(s,a){var o,i;e("#tmdb-"+a.id).length||(i="","non-existent"==a.db&&(i='<div id="cimprt-'+a.id+'" class="cimport" data-tmdb="'+a.id+'" data-type="'+a.tp+'"></div>'),o='<div class="image"><img src="'+a.im+'">'+i+"</div>",i='<div class="data"><h3>'+a.ti+"</h3><span>"+a.dt+"</span></div>",t.push('<div class="item fadein"><article class="'+a.db+'" id="tmdb-'+a.id+'">'+o+i+"</article></div>"))}),e("#response-dbmovies").before(t.join(""))},s.ComposeItemLog=function(s){var t,a,o,i;i=1==s.response?(t='<span class="type green">'+s.status+"</span>",a='<span class="type">'+s.type+"</span>",o='<a href="'+s.permalink+'" target="_blank">'+s.title+"</a>",t+a+'<span class="edit"><a href="'+s.editlink+'" target="_blank">'+dbmovies.editxt+"</a></span>"+o+'<span class="microtime">'+s.mtime+"</span>"):s.message,e("#dbmvs-log-indicator").after('<li class="bounce">'+i+"</li>")},s.ComposeFilterLog=function(s){var t,a,o;o=1==s.response?(t='<span class="type green">'+s.type+"</span>",a='<span class="microtime">'+s.mtime+"</span>",t+dbmovies.complt+a):s.message,e("#dbmvs-log-indicator").after('<li class="fadein">'+o+"</li>")},s.LoadMore=function(){e.each([".dbmvsloadmore.search",".dbmvsloadmore.filter"],function(s,t){e(document).on("click",t,function(){var s;return".dbmvsloadmore.filter"==t&&(s=parseInt(e("#dbmvs-page").val())),".dbmvsloadmore.search"==t&&(s=parseInt(e("#dbmvs-page").val())),s&&!e(this).hasClass("disabled")&&(".dbmvsloadmore.filter"==t&&(e("#dbmvs-page").val(++s),e("#dbmvs-btn-filter").trigger("click")),".dbmvsloadmore.search"==t&&(e("#dbmvs-search-page").val(++s),e("#dbmvs-btn-search").trigger("click"))),!1}),m&&e(window).scroll(function(){var s=e(this),a=e(".wrapp");e("#dtotal-items").val()<parseInt(c)&&s.scrollTop()>=a.height()-s.height()+240&&(e("#dbmovies-loadmore").hasClass("disabled")||setTimeout(function(){e(t).trigger("click")},500))})})},s.Importer=function(){1==e(_).length&&e(document).on("submit",_,function(){var s="#dbmovies-btn-importer",a="#dbmovies-inp-tmdb";return e(s).prop("disabled",!0),e(a).addClass("disabled"),e(s).val(dbmovies.loading),e(".wp-list-table").addClass("onprogress"),e(_).addClass("onprogress"),e("#dbmovies-loader").addClass("is-active"),e.ajax({url:t,type:"POST",dataType:"json",data:e(this).serialize(),success:function(t){1==t.response?window.location.replace(t.editlink):(alert(t.message),e(s).prop("disabled",!1),e(a).removeClass("disabled"),e(s).val(dbmovies.import),e(_).removeClass("onprogress"),e(".wp-list-table").removeClass("onprogress"),e("#dbmovies-loader").removeClass("is-active"))}}),!1})},s.GeneratorSeasons=function(){var a=e("#ids").val();e(document).on("click","#dbmovies-generator-seprepa",function(){var s=e("#tmdbseasos").val(),t=e("#tmdbsename").val();return e(this).prop("disabled",!0),s||t||e.getJSON(o+"/tv/"+a+"?language="+r+"&api_key="+n,function(s){var t=s.name||s.original_name;e("#tmdbsename").val(t),e.each(s,function(s,t){"number_of_seasons"==s&&(e("#tmdbseasos").val(t),e("#number_of_seasons").val(t),e("#dbmovies-json-response").html("0/"+t)),"number_of_episodes"==s&&e("#number_of_episodes").val(t)}),e("#dbmovies-generator-seprepa").removeClass("button-primary"),e(C).removeClass("button-secundary"),e(C).addClass("button-primary"),e(C).prop("disabled",!1)}),!1}),e(document).on("click",C,function(){var o=parseInt(e("#tmdbseason").val()),i=parseInt(e("#tmdbseasos").val()),n=e("#tmdbsename").val(),r=e("#postparent").val(),d=(o-1)/i*100;return e(this).prop("disabled",!0),e(this).hide(300),e("#dbmovies-loader").addClass("is-active"),s.Progress(d),o<=i?(e("#tmdbseason").val(o+1),e(f).html(o+"/"+i),e.ajax({url:t,type:"POST",dataType:"json",data:{tmdb:a,tmse:o,name:n,post:r,action:"dbmovies_generate_se"},success:function(s){1==s.response?(console.log(s.title+" - "+s.mtime),e(C).prop("disabled",!1),setTimeout(function(){e(C).trigger("click")},75)):location.reload()}})):location.reload(),!1})},s.GeneratorEpisodes=function(){var a=e("#ids").val(),i=e("#temporada").val();e(document).on("click","#dbmovies-generator-epprepa",function(){return e("#tmdbepisos").val(),e("#tmdbsename").val(),e(this).prop("disabled",!0),e.getJSON(o+"/tv/"+a+"?language="+r+"&api_key="+n,function(s){e.each(s.seasons,function(t,a){var o;i==a.season_number&&(o=s.name||s.original_name,e("#tmdbsename").val(o),e("#tmdbepisos").val(a.episode_count),e("#dbmovies-json-response").html("0/"+a.episode_count))}),e("#dbmovies-generator-epprepa").removeClass("button-primary"),e(k).removeClass("button-secundary"),e(k).addClass("button-primary"),e(k).prop("disabled",!1),"all"==u&&setTimeout(function(){e(k).trigger("click")},1500)}),!1}),e(document).on("click",k,function(){var o=parseInt(e("#tmdbepisod").val()),n=parseInt(e("#tmdbepisos").val()),r=e("#tmdbsename").val(),d=e("#postparent").val(),l=(o-1)/n*100;return e(this).prop("disabled",!0),e(this).hide(300),e("#dbmovies-loader").addClass("is-active"),s.Progress(l),o<=n?(e("#tmdbepisod").val(o+1),e(f).html(o+"/"+n),e.ajax({url:t,type:"POST",dataType:"json",data:{tmdb:a,tmse:i,tmep:o,name:r,post:d,action:"dbmovies_generate_ep"},success:function(s){1==s.response?(console.log(s.title+" - "+s.mtime),e(k).prop("disabled",!1),setTimeout(function(){e(k).trigger("click")},75)):"all"==u?window.close():location.reload()}})):"all"==u?window.close():location.reload(),!1})},s.Progress=function(s){e("#dbmovies-progress").animate({width:s+"%"},150,function(){})},s.NumberFormat=function(e){x=(e+="").split("."),x1=x[0],x2=1<x.length?"."+x[1]:"";for(var s=/(\d+)(\d{3})/;s.test(x1);)x1=x1.replace(s,"$1,$2");return x1+x2},s.setCookie=function(e,s,t){var a=new Date;a.setTime(a.getTime()+24*t*60*60*1e3),a="expires="+a.toUTCString(),document.cookie=e+"="+s+";"+a+";path=/"},s.getCookie=function(e){for(var s=e+"=",t=decodeURIComponent(document.cookie).split(";"),a=0;a<t.length;a++){for(var o=t[a];0==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(s))return o.substring(s.length,o.length)}return!1},s.delCookie=function(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"};var E={numberStep:function(s,t){s=Math.floor(s),e(t.elem).text(s)}};e.Tween&&e.Tween.propHooks?e.Tween.propHooks.number={set:T}:e.fx.step.number=T,e.animateNumber={numberStepFactories:{append:function(s){return function(t,a){var o=Math.floor(t);e(a.elem).prop("number",t).text(o+s)}},separator:function(s,t,a){return s=s||" ",t=t||3,a=a||"",function(o,i){var n,r,d=o<0,l=Math.floor((d?-1:1)*o).toString(),m=e(i.elem);l.length>t&&(r=function(e,s){for(var t,a,o,i=e.split("").reverse(),n=[],r=0,d=Math.ceil(e.length/s);r<d;r++){for(t="",o=0;o<s&&(a=r*s+o)!==e.length;o++)t+=i[a];n.push(t)}return n}(l,t),i=(n=r).length-1,r=w(n[i]),n[i]=w(parseInt(r,10).toString()),l=w(l=n.join(s))),m.prop("number",o).text((d?"-":"")+l+a)}}}},e.fn.animateNumber=function(){for(var s,t,a=arguments[0],o=e.extend({},E,a),i=e(this),n=[o],r=1,d=arguments.length;r<d;r++)n.push(arguments[r]);return a.numberStep&&(s=this.each(function(){this._animateNumberSetter=a.numberStep}),t=o.complete,o.complete=function(){s.each(function(){delete this._animateNumberSetter}),t&&t.apply(this,arguments)}),i.animate.apply(i,n)}}(jQuery);